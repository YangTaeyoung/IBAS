{% extends "base.html" %}
{% load static %}
{% block content %}
    <!--커스텀 css-->
    <link rel="stylesheet" type="text/css" href="{% static 'css/seungyeon.css' %}">
    <script src="{% static 'js/jquery.min.js' %}"></script><!-- JQUERY.MIN JS -->
    <script src="{% static 'js/sy.js' %}"></script>

    <div class="page-wraper">
        <div class="page-content bg-white">
            <div class="page-content bg-white">

                <!----------============= 상단 제목 시작 ================----------->
                <!--제목을 감싸는 배경-->
                <div class="dlab-bnr-inr dlab-bnr-inr-sm overlay-black-middle"
                     style=" background-image: url('{% static 'images/board_name_img.jpg' %}'); height: 350px">
                    <div class="container clearfix">
                        <div class="dlab-bnr-inr-entry">
                            <!--제목-->
                            <h1 class="text-white introduce-letter-spacing_5">동아리 활동</h1>
                            <!--부제목-->
                            <p class="introduce-margin-top_20">동아리 수상 및 활동 내역에 대한 게시판입니다.</p>
                        </div>
                    </div>
                </div>


                <!----------============= 본문 시작 ================----------->
                <div class="section-full content-inner">
                    <div class="container">
                        <div class="row" style="justify-content: center">
                            <div class="col-lg-8 col-xl-8 p-b30">
                                <div class="blog-post blog-single">
                                    <!-- 게시글 작성자 및 작성시간을 담는 div -->
                                    <div class="dlab-post-meta m-b20">
                                        <ul class="d-flex align-items-center">

                                            <!-- 게시글 작성자 -->
                                            <li class="post-author"><i
                                                    class="ti ti-user"></i>{{ board_info.board_writer.user_name }}</li>

                                            <!-- 게시글 작성시간 -->
                                            <li class="post-comment"><i
                                                    class="ti ti-alarm-clock"></i>{{ board_info.board_created }}</li>
                                        </ul>
                                    </div>

                                    <!-- 게시글 제목 -->
                                    <div class="dlab-post-title ">
                                        <h2 class="post-title m-t0">
                                            {{ board_info.board_title }}
                                        </h2>
                                    </div>
                                    <!--============================== 게시글 본문 시작 ==============================-->
                                    <div class="dlab-post-text">

                                        <!--  =============== 게시글 내용 ====== -->
                                        {% autoescape off %}
                                            <p id="post-text-cont" class="font-weight-400">
                                                {{ board_info.board_cont }}
                                            </p>
                                        {% endautoescape %}

                                        <!-- 게시글 속 사진 모음 -->
                                        <div class="widget widget_gallery gallery-grid-4 lightgallery">
                                            <ul>
                                                {% for image in board_info.boardfile_set.all %}
                                                    <li>
													<span data-exthumbimage="/media/{{ image.board_file_path }}"
                                                          data-src="/media/{{ image.board_file_path }}"
                                                          class="check-km " title="Light Gallery Grid 1">
														<a href="javascript:void(0);">
															<div class="dlab-post-thum act-detail-img-size"><img
                                                                    style="height: 190px"
                                                                    src="/media/{{ image.board_file_path }}"
                                                                    alt=""></div>

                                                            <!-- 이 부분이 더 나오게 하는 작업. -->
{#                                                            <div class="more-images">#}
{#																<div>#}
{#																	<strong>6</strong>#}
{#																	<span>Images</span>#}
{#																</div>#}
{#															</div>#}

														</a>
													</span>
                                                    </li>
                                                {% endfor %}
                                            </ul>
                                        </div>

                                        <!-- 게시글 삭제 및 수정 div -->
                                        <!-- ############ 현재 세션과 작성자의 학번이 같아야 수정, 삭제 파트가 보인다. ### -->
                                        {% if request.session.user_stu == board_info.board_writer.user_stu %}
                                            <div class="extra-cell text-right">

                                                <!-- 게시글 수정 버튼 -->
                                                <form action="{% url 'activity_update' %}" method="GET">
                                                    <button type="submit" name="board_no"
                                                            class="site-button radius-xl m-l10"
                                                            onclick="return confirm('수정하시겠습니까?')"><i
                                                            class="fa fa-pencil m-r5"></i> 게시글 수정
                                                        <input type="hidden" name="board_no"
                                                               value="{{ board_info.board_no }}">
                                                    </button>
                                                </form>

                                                <!-- 게시글 삭제 버튼 -->
                                                <form action="{% url 'activity_delete' %}" method="POST">
                                                    {% csrf_token %}
                                                    <button type="submit" class="site-button red radius-xl m-l10"
                                                            onclick="return confirm('정말 삭제하시겠습니까?')"><i
                                                            class="fa fa-trash m-r5"></i>게시글 삭제
                                                        <input type="hidden" name="board_no"
                                                               value="{{ board_info.board_no }}">
                                                    </button>
                                                </form>
                                            </div>
                                        {% endif %}

                                        <!-- 게시글과 댓글을 구분짓는 구분선 -->
                                        <div class="dlab-divider bg-gray-dark"></div>
                                    </div>


                                    <div class="clear" id="comment-list">
                                        <div class="comments-area" id="comments">
                                            <h3 class="font-26">댓글
                                            </h3>
                                            <div class="clearfix">
                                                <!-- comment list END -->
                                                <ol class="comment-list">

                                                    <!--  ################# 여기서부터 댓글 작업 ###################  -->
                                                    {% for comment in comment_info %}
                                                        <li class="comment">
                                                            <div class="comment-body">

                                                                <!-- ################# 이름 및 프로필 사진 ################ -->
                                                                <div class="comment-author vcard"><cite class="fn"><img
                                                                        src="{{ comment.comment_writer.user_pic }}"
                                                                        width="35"
                                                                        height="35" class="comment-profile-size"
                                                                        alt="현재 브라우저에서 지원하지 않는 형식입니다.">{{ comment.comment_writer.user_name }}
                                                                </cite></div>

                                                                <div class="dlab-post-meta m-l10">
                                                                    <ul class="d-flex">
                                                                        <!-- ############# 게시글 작성한 사람의 학과  ################# -->
                                                                        <li class="post-author">{{ comment.comment_writer.user_major.major_name }}</li>

                                                                        <!-- ############# 게시글 작성시간 ################ -->
                                                                        <li class="post-comment"><i
                                                                                class="ti ti-alarm-clock"></i>작성시간
                                                                            : {{ comment.comment_created }}</li>
                                                                    </ul>
                                                                </div>

                                                                <input type="text" disabled="disabled" name="comment_cont"
                                                                       style="width: 706px"
                                                                       class="comments-area" id="comment_no_2"
                                                                       value="{{ comment.comment_cont }} ">

                                                                <div id="comment_no_1" class="reply-btn-div">
                                                                    <!-- comment-no-1은 comment 테이블에서 COMMENT_ID(덧글번호)를 의미함 -->

                                                                    <!-- 코드 수정해야함 ㅇ -->
                                                                    {% if comment.comment_cont_ref == None %}
                                                                        <button id="comment-no-1" type="button"
                                                                                class="btnAdd comment-btn m-r20"><i
                                                                                class="fa fa-commenting m-r5"></i>답글쓰기
                                                                        </button>
                                                                    {% endif %}


                                                                    {% if request.session.user_stu == comment.comment_writer.user_stu %}
                                                                        {# ##########################댓글수정파트 #########################  #}
                                                                        <form action="{% url 'activity_comment_update' %}"
                                                                              method="POST">
                                                                            {% csrf_token %}

                                                                            <button id="re-comment" type="submit"
                                                                                    class="comment-btn m-r10"><i
                                                                                    class="fa fa-pencil m-r5"></i>댓글 수정
                                                                            </button>
                                                                            <!-- ########## 여기서 댓글 번호 넘겨준다. ############# -->
                                                                            <input type="hidden"
                                                                                   value="{{ comment.comment_id }}"
                                                                                   name="comment_id">
                                                                        </form>

                                                                        {# ####################### 댓글삭제 파트 ########################## #}
                                                                        <form action="{% url 'activity_comment_delete' %}"
                                                                              method="POST">
                                                                            {% csrf_token %}
                                                                            <button type="submit"
                                                                                    onclick="return confirm('정말 삭제하시겠습니까?')"
                                                                                    class="comment-btn m-r10"><i
                                                                                    class="fa fa-trash m-r5"></i>
                                                                                댓글 삭제
                                                                                <!-- ########## 여기서 댓글 번호 넘겨준다. ############# -->
                                                                                <input type="hidden"
                                                                                       value="{{ comment.comment_id }}"
                                                                                       name="comment_id">
                                                                            </button>
                                                                        </form>

                                                                        {#                                                                        <form action="{% url 'activity_comment_update' %}" method="POST">#}
                                                                        {#                                                                        {% csrf_token %}#}
                                                                        {#                                                                        <button id="re-comment"#}
                                                                        {#                                                                                class="comment-btn m-r10"><i#}
                                                                        {#                                                                                class="fa fa-pencil m-r5"></i>댓글 수정#}
                                                                        {#                                                                            <!-- ########## 여기서 댓글 번호 넘겨준다. ############# -->#}
                                                                        {#                                                                                <input type="hidden"#}
                                                                        {#                                                                                       value="{{ comment.comment_id }}"#}
                                                                        {#                                                                                       name="comment_id">#}
                                                                        {#                                                                        </button>#}
                                                                        {#                                                                        </form>#}
                                                                    {% endif %}

                                                                </div>
                                                            </div>
                                                        </li>


                                                        <!-- ########### 여기선 대댓글 파트 ############ -->
                                                        <li class="comment">
                                                            <div class="comment-body" style="margin-left: 20px;">
                                                                <div class="comment-author vcard"><cite class="fn"><img
                                                                        src="{{ request.session.user_pic }}" width="35"
                                                                        height="35" class="comment-profile-size"
                                                                        alt="현재 브라우저에서 지원하지 않는 형식입니다.">123신승연</cite>
                                                                </div>

                                                                <div class="dlab-post-meta m-l10">
                                                                    <ul class="d-flex">
                                                                        <!-- 게시글 작성일자 -->
                                                                        <li class="post-author"><a
                                                                                href="javascript:void(0);">경영학과 17학번</a>
                                                                        </li>
                                                                        <!-- 게시글 작성시간 -->
                                                                        <li class="post-comment"><i
                                                                                class="ti ti-alarm-clock"></i> <a
                                                                                href="javascript:void(0);">19 hours
                                                                            ago</a>
                                                                        </li>
                                                                    </ul>
                                                                </div>
                                                                <input type="text" disabled="disabled"
                                                                       style="width: 706px"
                                                                       class="comments-area" id="comment_no_2"
                                                                       value="댓글 구현하기 정말 잣같구만,,,, 시부렐">
                                                                <div class="reply-btn-div">
                                                                    <button id="" class="comment-btn m-r10"><i
                                                                            class="fa fa-pencil m-r5"></i>댓글 수정
                                                                    </button>
                                                                    <a href="#"
                                                                       class="m-r10"><i
                                                                            class="fa fa-trash m-r5"></i>
                                                                        게시글 삭제</a>
                                                                </div>
                                                            </div>
                                                        </li>
                                                    {% endfor %}

                                                </ol>
                                            </div>
                                            </li>
                                            </ol>
                                            <!-- comment list END -->


                                            <!-- 회원들만 댓글을 달 수 있게 해야함. -->
                                            {% if request.session.user_auth == 1 or request.session.user_auth == 2 or request.session.user_auth == 3 or request.session.user_auth == 4 %}
                                                <div class="dlab-divider bg-gray-dark"></div>
                                                <div class="" id="respond">
                                                    <!-- ##################### 댓글 등록 파트 ################# -->
                                                    <form class="comment-form" id="commentform" method="GET"
                                                          action="{% url 'activity_comment' %}">
                                                        <p class="comment-form-comment">
                                                            <label for="comment">Comments</label>
                                                            <textarea rows="8" name="activity_comment"
                                                                      placeholder="댓글을 남겨보세요!"
                                                                      id="comment"></textarea>
                                                        </p>

                                                        <p class="form-submit" style="text-align: right">
                                                            <input type="submit" value="댓글등록"
                                                                   class="submit site-button" id="submit"
                                                                   name="submit">
                                                            <input type="hidden" name="board_no"
                                                                   value="{{ board_info.board_no }}">
                                                        </p>
                                                    </form>
                                                </div>
                                            {% endif %}
                                            <!-- Form -->

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <!-- 상단으로 올라가는 버튼 -->
        <button class="scroltop fa fa-chevron-up"></button>
    </div>
    </div>
{% endblock %}
