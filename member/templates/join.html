{% load static %}
{% load widget_tweaks %}
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- 여기서부터 기존 템플릿에 있던 것 -->
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="keywords" content=""/>
    <meta name="author" content=""/>
    <meta name="robots" content=""/>
    <meta
            name="description"
            content="BizMap Directory & Listings HTML templates"
    />
    <meta
            property="og:title"
            content="BizMap Directory & Listings HTML templates"
    />
    <meta
            property="og:description"
            content="BizMap Directory & Listings HTML templates"
    />
    <meta property="og:image" content=""/>
    <meta name="format-detection" content="telephone=no"/>

    <!-- 주소창 상단 아이바스 로고 아이콘 -->
    <link
            rel="icon"
            href="{% static 'images/member_logo.png' %}"
            type="image/x-icon"
    />
    <link
            rel="shortcut icon"
            type="image/x-icon"
            href="{% static 'images/member_logo.png' %}"
    />

    <!-- PAGE TITLE HERE -->
    <title>입부신청</title>

    <!-- MOBILE SPECIFIC -->
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--[if lt IE 9]>
      <script src="{% static 'js/html5shiv.min.js' %}"></script>
      <script src="{% static 'js/respond.min.js' %}"></script>
    <![endif]-->

    <!-- STYLESHEETS -->
    <link
            rel="stylesheet"
            type="text/css"
            href="{% static 'css/plugins.css' %}"
    />
    <link
            rel="stylesheet"
            type="text/css"
            href="{% static 'css/style.css' %}"
    />
    <link
            rel="stylesheet"
            type="text/css"
            href="{% static 'css/templete_1.css' %}"
    />
    <link
            class="skin"
            rel="stylesheet"
            type="text/css"
            href="{% static 'css/skin/skin-1.css' %}"
    />

    <!-- 여기까지 기존 템플릿에 있던 것 -->
    <!--외부 css파일 받는 링크 / 이 html에서만 쓰는 것. -->
    <link rel="stylesheet" href="{% static 'css/login-join.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/size.css' %}">
    <script>
        phoneIsNotOK = 0; // 핸드폰 중복 체크를 위한 변수 0:정상 1: 중복이 있음
        stuIsNotOK = 0;// 학 중복 체크를 위한 변수 0:정상 1: 중복이 있음

        function stu_check() // 학번 중복 체크를 위한 함수
        {
            const stu_chk = document.getElementById("user_stu");// 사용자가 입력한 학번 오브젝트
            {% for user_stu in stu_list %}
                if (stu_chk.value === "{{ user_stu }}") // 이미 데이터베이스와 일치하는 학번이 있을경우
                {
                    document.getElementById("error_text_stu").style.display = "block"; // 에러메시지 출력
                    stuIsNotOK = 1; // 중복 변수를 비정상으로 바꿈
                    return 0;
                }
            {% endfor %}
            document.getElementById('error_text_stu').style.display = 'none';
            stuIsNotOK = 0;
        }

        function phone_check() // 핸드폰 중복 체크를 위한 함수
        {
            const phone_chk = document.getElementById("user_phone");

            {% for phone in phone_list %}
                if (phone_chk.value === "{{ phone }}") // 이미 유저 DB에 중복되는 핸드폰 번호가 존재하는 경우
                {
                    document.getElementById("error_text_phone").style.display = "block"; // 에러메시지 출력
                    phoneIsNotOK = 1; // 중복 변수를 비정상으로 바꿈
                    return 0;
                }
            {% endfor %}
            document.getElementById('error_text_phone').style.display = 'none';
            phoneIsNotOK = 0;
        }

        function form_check() {
            if (stuIsNotOK !== 0 || phoneIsNotOK !== 0) // 학번과 핸드폰 중 하나라도 중복이 있는 경우
            {
                alert("회원 입력 양식을 다시 한번 확인하세요")
            } else // 모두 정상인 경우
            {
                document.getElementById("id_user_stu").value = document.getElementById("user_stu").value
                document.getElementById("btn-next").click(); // 보이지 않는 submit 버튼을 클릭하도록 설정.
            }

        }

        function maxLengthCheck(object) {
            if (object.value.length > object.maxLength) {
                object.value = object.value.slice(0, object.maxLength);
            }
        }

        function key_check(object) {
            object.value = object.value.replace(/[^0-9]/g, '');
        }
    </script>
    <style>
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>
</head>
<body id="bg">
<div id="loading-area"></div>
<div class="page-wraper">
    <!-- Content -->
    <div class="page-content dlab-login bg-primary"
         style="background-position: top right; background-blend-mode: screen">
        <div class="container-flex">
            <div class="item_flex_lgn login-form-box">
                <!-- 여기서부터 로그인 양식 시작  -->
                <!-- 세로로 길쭉한 컨테이너-->
                <div class="login-form form-position-center" style="left: -1%">
                    <!--길쭉한 컨테이너 속 컨텐츠 컨테이너-->
                    <div class="join-frame">
                        <!-- 동아리 로고  -->
                        <div class="logo-container-flex">
                            <!-- a 태그로 인해 동아리 로고 클릭하면 메인화면으로 감.  -->
                            <a href="{% url 'index' %}">
                                <div>
                                    <img src="{% static 'images/member_logo.png' %}" alt="현재 브라우저에서는 지원하지 않는 형식입니다."
                                         width="150" height="150">
                                </div>
                            </a>
                        </div>

                        <!-- 회원 가입 입력 폼 시작z -->
                        <form id="join-form" action="
                                {% if user_role == "6" %}{% url 'join_chk' %}{% else %}{% url 'quest_chk' %}{% endif %}"
                              method="post">
                            <!-- 회원 가입 확인 함수:join_chk()로 전송 -->
                            <!--POST전송을 위한 CSRF 토큰-->
                            {% csrf_token %}
                            <!-- 바로 사용하지 못하는 것들은 사전 설정함. -->
                            {% for hidden_field in user_form.hidden_fields %}
                                {{ hidden_field }}
                            {% endfor %}
                            {% for hidden_field in user_email_form.hidden_fields %}
                                {{ hidden_field }}
                            {% endfor %}
                            <input type="hidden" name="user_pic" value="{{ pic }}"/>
                            <!-- 입부신청 작성란 시작 -->
                            <!-- 단답 작성란 시작 -->
                            <div class="tab-content nav">
                                <!-- <div id="register" class="tab-pane fade"> -->
                                <div id="register" class="tab-pane active">
                                    <div class="hr-sect">기본정보</div>
                                    <!--이름 input / 구글이나 네이버로부터 정보 받아옴-->
                                    <div class="form-group mb-0">
                                        {% render_field user_form.user_name id='user_name' class='form-control' %}
                                    </div>
                                    <p class="mb-1 mt-1" style="font-size: 8pt;color:red;line-height: 120%">
                                        <i class="la la-check"></i>
                                        &nbsp;학번이 학생 DB와 대조 후 일치하지 않을 시, 가입을 승인하지 않습니다.<br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;실명과
                                        학번이 맞는지 다시 한 번 확인해주세요.
                                    </p>

                                    <!--이메일은 수정하지 못하도록 고정 / 구글이나 네이버로부터 정보 받아옴-->
                                    <!-- 안에 적힐 내용의 css는 form-control_instead에서 지정함.  -->
                                    <div class="form-group form-control_instead" style="background-color: #bcbcbc">
                                        <b>{{ user_email }}</b>
                                    </div>
                                    <!-- 핸드폰 번호 input -->
                                    <div class="form-group">
                                        {% render_field user_form.user_phone id="user_phone" class="form-control" onfocusout="phone_check()" onkeyup="inputPhoneNumber(this)" %}
                                    </div>
                                    <p id="error_text_phone" class="error-text">입력한 핸드폰 번호가 중복됩니다.</p>
                                    <!-- 학년, 학번 컨테이너 -->
                                    <div class="form-container-flex form-group m-b0">
                                        <!--학년 컨테이너-->
                                        {% if user_role == "6" %}
                                            <div class="width-100">
                                                {% render_field user_form.user_grade %}
                                            </div>
                                        {% else %}
                                            <input type="hidden" name="user_grade" value="5"/>
                                        {% endif %}
                                        <!-- 학번 input -->
                                        <div class="form-group form-item-flex-std-no">

                                            {% if user_role == "6" %}
                                                {% render_field user_form.user_stu id="user_stu" class="form-control" placeholder="학번(ex. 1219****)" maxlength="8" oninput="maxLengthCheck(this)" onfocusout="stu_check()" onkeyup="key_check(this)" %}
                                            {% else %}
                                                {% render_field user_form.user_stu id="user_stu" class="form-control" placeholder="교수번호" maxlength="6" oninput="maxLengthCheck(this)" onfocusout="stu_check()" onkeyup="key_check(this)" %}
                                            {% endif %}

                                        </div>

                                    </div>
                                    <p id="error_text_stu" class="error-text">입력하신 {% if user_role == "6" %}
                                        학번이{% else %}교수번호가{% endif %} 이미 가입되어 있습니다.</p>
                                    <!-- 전공 input -->
                                    <div class="form-container-flex form-group m-b0">
                                        <div class="width-400">
                                            <input id="user_major" class="form-control_instead" type="text"
                                                   placeholder="전공을 입력하려면 클릭하세요." required="required"
                                                   readonly="readonly"
                                                   onclick="popUp()"/>
                                        </div>

                                        <!-- 전공 검색 버튼 -->
                                        <div class="form-group" onclick="popUp()">
                                            <i class="fa fa-search fa-2x form-item-flex-major-icon search-btn"></i>
                                        </div>
                                    </div>

                                    <!-- 입부신청 버튼 -->
                                    <div class="form-group mt-5 mb-5">
                                        <button class="site-button button-md" style="width: 100%;" type="button"
                                                onclick="form_check()">다음
                                        </button>
                                    </div>
                                    <input style="display: none" type="submit" id="btn-next" value="다음"/>
                                </div>
                            </div>
                            <!-- 입부신청 작성란  -->
                        </form>
                    </div>
                </div>
            </div>

            <!-- 오른쪽 이미지를 넣을 장소 시작 -->
            <div class="item_flex_bg">
                <img style="height: 100%; width: 100%" src="{% static 'images/blue-purple-technology-circuit.jpg' %}">
            </div>
            <!--오른쪽 이미지 넣을 장소 끝-->
        </div>
    </div>
</div>
<div id="gray_shadow" class="gray_shadow" onclick="popDown()"></div>
<!-- 전공 검색 팝업창 -->
<div id="major-search-popup" class="card major-search-popup" style="width: 450px; height: 380px">
    <div class="card-header" style="display: flex; align-items: center; justify-content: space-between">
        <h4 class="m-b0"> 전공 검색 </h4>
        <!-- 닫기 버튼 -->
        <i class="fa fa-close fa-2x btn-exit" onclick="popDown()"></i>
    </div>
    <div class="card-body" style="display: flex; height: auto">

        <!-- 검색 영역 -->
        <div class="searchBox" style="width: 100%; margin-top: 20px; margin-left: 20px">
            <input class="form-control" type="text" id="search" onkeyup="filter()" placeholder="전공을 입력하세요"/>
        </div>
        <!-- 전공 리스트 영역 -->

        <div class="listBox" style="width: 100%; margin-left: 20px">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>학교명</th>
                    <th>단과대학</th>
                    <th>학과명</th>
                </tr>
                </thead>
                <tbody>
                <!--전공 리스트를 단과대학, 학과명 순으로 가져옴-->
                {% for major in major_list %}
                    <tr class="listInner" onclick="printResult({{ major.major_no }})">
                        <th>인하대학교</th>
                        <td class="colleges">{{ major.major_colleage }}</td>
                        <td id="major_name_{{ major.major_no }}" class="major_names">{{ major.major_name }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Content END-->
<button class="scroltop fa fa-chevron-up"></button>


<!-- JAVASCRIPT FILES ========================================= -->
<!-- 직접 만든 회원 가입 관련 JS-->
<script src="{% static 'js/login-join.js' %}"></script>


<script src="{% static 'js/jquery.min.js' %}"></script>
<!-- JQUERY.MIN JS -->
<script src="{% static 'plugins/bootstrap/js/popper.min.js' %}"></script>
<!-- BOOTSTRAP.MIN JS -->
<script src="{% static 'plugins/bootstrap/js/bootstrap.min.js' %}"></script>
<!-- BOOTSTRAP.MIN JS -->
<script src="{% static 'plugins/bootstrap-select/bootstrap-select.min.js' %}"></script>
<script src="{% static 'plugins/bootstrap-select/bootstrap-select.min.js' %}"></script>
<!-- FORM JS -->
<script src="{% static 'plugins/bootstrap-touchspin/jquery.bootstrap-touchspin.js' %}"></script>
<!-- FORM JS -->
<script src="{% static 'plugins/magnific-popup/magnific-popup.js' %}"></script>
<!-- MAGNIFIC POPUP JS -->
<script src="{% static 'plugins/counter/waypoints-min.js' %}"></script>
<!-- WAYPOINTS JS -->
<script src="{% static 'plugins/counter/counterup.min.js' %}"></script>
<!-- COUNTERUP JS -->
<script src="{% static 'plugins/imagesloaded/imagesloaded.js' %}"></script>
<!-- IMAGESLOADED -->
<script src="{% static 'plugins/masonry/masonry-3.1.4.js' %}"></script>
<!-- MASONRY -->
<script src="{% static 'plugins/masonry/masonry.filter.js' %}"></script>
<!-- MASONRY -->
<script src="{% static 'plugins/rangeslider/rangeslider.js' %}"></script>
<!-- RANGESLIDER -->
<script src="{% static 'plugins/owl-carousel/owl.carousel.js' %}"></script>
<!-- OWL SLIDER -->
<script src="{% static 'js/custom.js' %}"></script>
<!-- CUSTOM FUCTIONS  -->
<script src="{% static 'js/dz.carousel.js' %}"></script>
<!-- SORTCODE FUCTIONS  -->
<script src="{% static 'js/dz.ajax.js' %}"></script>
<!-- CONTACT JS  -->


</body>
</html>
